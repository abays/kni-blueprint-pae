---
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  labels:
    machineconfiguration.openshift.io/role: worker-rt
  name: machine-config-worker-rt
spec:
  config:
    ignition:
      version: 2.2.0
    storage:
      files:
        -
          contents:
            source: data:text/plain;base64,Qk9PVF9JTUFHRT0vdm1saW51ei0zLjEwLjAtMTA2Mi4xLjIucnQ1Ni4xMDI1LmVsNy54ODZfNjQgcm9vdD0vZGV2L21hcHBlci9yaGVsX2JhYnlsb24tcm9vdCBybyBjcmFzaGtlcm5lbD1hdXRvIHNwZWN0cmVfdjI9cmV0cG9saW5lIHJkLmx2bS5sdj1yaGVsX2JhYnlsb24vcm9vdCByZC5sdm0ubHY9cmhlbF9iYWJ5bG9uL3N3YXAgY29uc29sZT10dHkwIExBTkc9ZW5fVVMuVVRGLTggc2tld190aWNrPTEgaXNvbGNwdXM9Mi0zNSBpbnRlbF9wc3RhdGU9ZGlzYWJsZSBub3NvZnRsb2NrdXAgbm1pX3dhdGNoZG9nPTAgYXVkaXQ9MCBtY2U9b2ZmIGt0aHJlYWRfY3B1cz0wIGlycWFmZmluaXR5PTAgc2tld190aWNrPTEgcHJvY2Vzc29yLm1heF9jc3RhdGU9MSBpZGxlPXBvbGwgaW50ZWxfaWRsZS5tYXhfY3N0YXRlPTAgaW50ZWxfcHN0YXRlPWRpc2FibGUgaW50ZWxfaW9tbXU9b2ZmIGRlZmF1bHRfaHVnZXBhZ2Vzej0xRyBodWdlcGFnZXN6PTFHIGh1Z2VwYWdlcz0zMiBub2h6PW9uIG5vaHpfZnVsbD0yLTM1IHJjdV9ub2Nicz0yLTM1CgojIS9iaW4vYmFzaAppZiBbIC1mIC9ldGMvY2VudG9zLXJlbGVhc2UgXTsgdGhlbgogICAgc3VkbyB0ZWUgL2V0Yy95dW0ucmVwb3MuZC9DZW50T1MtcnQucmVwbyA+L2Rldi9udWxsIDw8RU9GCiMgQ2VudE9TLXJ0LnJlcG8KCltydF0KbmFtZT1DZW50T1MtNyAtIHJ0CmJhc2V1cmw9aHR0cDovL21pcnJvci5jZW50b3Mub3JnL2NlbnRvcy9cJHJlbGVhc2V2ZXIvcnQvXCRiYXNlYXJjaC8KZ3BnY2hlY2s9MQpncGdrZXk9ZmlsZTovLy9ldGMvcGtpL3JwbS1ncGcvUlBNLUdQRy1LRVktQ2VudE9TLTcKRU9GCiAgICB5dW0gdXBkYXRlIC15CiAgICB5dW0gcmVtb3ZlIC15IHR1bmVkCiAgICB5dW0gaW5zdGFsbCAteSBrZXJuZWwtcnQgcnQtdGVzdHMgdHVuZWQtcHJvZmlsZXMtcmVhbHRpbWUKZWxzZQogICAgIyBhZGQgcmlnaHQgcmVhbHRpbWUgcGFja2FnZSBkZXBlbmRpbmcgb24gdmVyc2lvbgogICAgaWYgW1sgIiQoY2F0IC9ldGMvcmVkaGF0LXJlbGVhc2UpIiA9fiAiTWFpcG8iIF1dOyB0aGVuCiAgICAgICAgc3Vic2NyaXB0aW9uLW1hbmFnZXIgcmVwb3MgLS1lbmFibGUgcmhlbC03LXNlcnZlci1ydC1ycG1zCiAgICBlbHNlCiAgICAgICAgc3Vic2NyaXB0aW9uLW1hbmFnZXIgcmVwb3MgLS1lbmFibGUgcmhlbC04LWZvci14ODZfNjQtcnQtcnBtcwogICAgZmkKICAgIHl1bSBncm91cGluc3RhbGwgLXkgUlQKZmkKCmNtZGxpbmVfcmVhbHRpbWU9Iitpc29sY3B1cz1cJHtpc29sYXRlZF9jb3Jlc30gaW50ZWxfcHN0YXRlPWRpc2FibGUgbm9zb2Z0bG9ja3VwIG5taV93YXRjaGRvZz0wIGF1ZGl0PTAgbWNlPW9mZiBrdGhyZWFkX2NwdXM9MCBpcnFhZmZpbml0eT0wIHNrZXdfdGljaz0xIHByb2Nlc3Nvci5tYXhfY3N0YXRlPTEgaWRsZT1wb2xsIGludGVsX2lkbGUubWF4X2NzdGF0ZT0wIGludGVsX3BzdGF0ZT1kaXNhYmxlIGludGVsX2lvbW11PW9uIGlvbW11PXB0IGRlZmF1bHRfaHVnZXBhZ2Vzej1cJHtodWdlcGFnZV9zaXplX2RlZmF1bHR9IGh1Z2VwYWdlc3o9XCR7aHVnZXBhZ2Vfc2l6ZX0gaHVnZXBhZ2VzPVwke2h1Z2VwYWdlX251bX0gbm9oej1vbiBub2h6X2Z1bGw9XCR7aXNvbGF0ZWRfY29yZXN9IHJjdV9ub2Nicz1cJHtpc29sYXRlZF9jb3Jlc30iCgpzZWQgLWkgJ3N8XmNtZGxpbmVfcmVhbHRpbWUuKnxjbWRsaW5lX3JlYWx0aW1lPSciJHtjbWRsaW5lX3JlYWx0aW1lfSInfCcgL3Vzci9saWIvdHVuZWQvcmVhbHRpbWUvdHVuZWQuY29uZiAgCgojIGFkZCBkeW5hbWljIGlzb2xhdGVkIGNvcmVzCmNwIC90bXAvcmVhbHRpbWUtdmFyaWFibGVzLmNvbmYgL2V0Yy90dW5lZC9yZWFsdGltZS12YXJpYWJsZXMuY29uZgplY2hvICJpc29sYXRlZF9jb3Jlcz0yLSQoKCQoY2F0IC9wcm9jL2NwdWluZm8gfCBhd2sgJy9ecHJvY2Vzc29yL3twcmludCAkM30nIHwgd2MgLWwpIC0xICkpIiA+PiAvZXRjL3R1bmVkL3JlYWx0aW1lLXZhcmlhYmxlcy5jb25mCgpzeXN0ZW1jdGwgc3RhcnQgdHVuZWQKc3lzdGVtY3RsIGVuYWJsZSB0dW5lZAp0dW5lZC1hZG0gcHJvZmlsZSByZWFsdGltZQoKdG91Y2ggL29wdC9ydF9leGVjdXRlZApyZWJvb3QK
          filesystem: root
          mode: 0777
          path: /opt/setup_rt.sh
    systemd:
      units:
        -
          contents: |
            [Unit]
            Description=One time service to install rt and tuned profile
            After=network-online.target
            ConditionPathExists=!/opt/rt_executed
            [Service]
            Type=oneshot
            ExecStart=/opt/setup_rt.sh
            [Install]
            WantedBy=multi-user.target
          enabled: true
          name: install_realtime.service
